<!-- SCRIPT GIVES THE MOUSE COORDINATES - Hold SHIFT and click two points to draw a rectangle -->
<!-- The popup will state the rectangle's position. Hover your mouse over the rectangle to also get its position. -->
<!-- Press the Escape button on the keyboard to delete the most recently drawn rectangle  -->
<script type="text/javascript" language="javascript">
const isIE = document.all?true:false;
if (!isIE) document.captureEvents(Event.MOUSEMOVE);

document.onmousemove = getMousePosition;
document.onclick = drawRectangle;
document.onkeydown = deleteLastRectangle;
let capX1 = -1;
let capY1 = -1;

function addRectangleListDiv(){
   const rectangle_list = document.createElement("div");
   rectangle_list.id = "rectangle_list";
   document.body.appendChild(rectangle_list);
}

function getMousePosition(e) {
   // if no longer holding shift key, reset position of capX1, capY1
   if(!e.shiftKey){
      capX1 = -1;
      capY1 = -1;
   }

   let _x;
   let _y;
   if (!isIE) {
      _x = e.pageX;
      _y = e.pageY;
   }
   document.title = _x + " " + _y;
   return true;
}

// Delete the last rectangle drawn
function deleteLastRectangle(e){
   if (e.key == "Escape"){
      const rectangle_list = document.getElementById("rectangle_list");
      if (rectangle_list != null){
         const lastChild = rectangle_list.lastChild;
         if (lastChild != null){
            rectangle_list.removeChild(lastChild);
         }
      }
   }
}

function drawRectangle(e) {
   if (e.shiftKey) {
      if ((capX1 == -1) && (capY1 == -1)) {
         capX1 = e.pageX;
         capY1 = e.pageY;
      } else {
         // get rectangle coordinates
         const capX2 = e.pageX;
         const capY2 = e.pageY;
         const diffX = capX2-capX1;
         const diffY = capY2-capY1;
         const left = capX1 < capX2 ? capX1 : capX2;
         const top = capY1 < capY2 ? capY1 : capY2;
         const width = Math.abs(diffX);
         const height = Math.abs(diffY);

         // create rectangle
         const rectangle = document.createElement("div");
         rectangle.style = `position:absolute; left:${left}px; top:${top}px; width:${width}px; height:${height}px; border:2px solid red; background-color: transparent"`
         rectangle.title = `left:${left}px; top:${top}px; width:${width}px; height:${height}px`

         // create div rectangle_list, if not already exists
         // add rectangle to rectangle_list
         let rectangle_list = document.getElementById("rectangle_list");
         if (rectangle_list == null){
            addRectangleListDiv();
            rectangle_list = document.getElementById("rectangle_list");
         }
         rectangle_list.appendChild(rectangle);

         setTimeout(() =>{
            alert(`left:${left}px; top:${top}px; width:${width}px; height:${height}px; `);
         }, 250);

         capX1 = -1;
         capY1 = -1;
      }
   }
}
</script>
<!-- ----------End coordinate script--------------------------------------------------------- -->